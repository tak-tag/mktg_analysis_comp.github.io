<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>プロビットモデルの推定と解釈 | マーケティング・データ分析補足資料</title>
  <meta name="description" content="プロビットモデルの推定と解釈 | マーケティング・データ分析補足資料" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="プロビットモデルの推定と解釈 | マーケティング・データ分析補足資料" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="https://github.com/tak-tag/mktg_analysis_comp.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="プロビットモデルの推定と解釈 | マーケティング・データ分析補足資料" />
  
  
  



<meta name="date" content="2025-11-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="discretechoice.html"/>
<link rel="next" href="ml.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>本ウェブサイトについて</a></li>
<li class="chapter" data-level="" data-path="rusage.html"><a href="rusage.html"><i class="fa fa-check"></i>R と R studioに慣れる</a>
<ul>
<li class="chapter" data-level="" data-path="ch2intro.html"><a href="ch2intro.html"><i class="fa fa-check"></i>本章の概要</a></li>
<li class="chapter" data-level="" data-path="desktop.html"><a href="desktop.html"><i class="fa fa-check"></i>R studio デスクトップ版の利用</a></li>
<li class="chapter" data-level="" data-path="project.html"><a href="project.html"><i class="fa fa-check"></i>プロジェクト機能について</a></li>
<li class="chapter" data-level="" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i>Rの基本操作</a></li>
<li class="chapter" data-level="" data-path="rscript.html"><a href="rscript.html"><i class="fa fa-check"></i>R スクリプトのすゝめ</a>
<ul>
<li class="chapter" data-level="" data-path="rscript.html"><a href="rscript.html#writeRscript"><i class="fa fa-check"></i>Rスクリプトを書く</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch2summary.html"><a href="ch2summary.html"><i class="fa fa-check"></i>本章のまとめ</a></li>
<li class="chapter" data-level="" data-path="positcloud.html"><a href="positcloud.html"><i class="fa fa-check"></i>コラム：Posit cloudを使ってみる</a></li>
<li class="chapter" data-level="" data-path="ch2reference.html"><a href="ch2reference.html"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="handling.html"><a href="handling.html"><i class="fa fa-check"></i>データ整理と要約・可視化</a>
<ul>
<li class="chapter" data-level="" data-path="Ch3intro.html"><a href="Ch3intro.html"><i class="fa fa-check"></i>本章の概要</a></li>
<li class="chapter" data-level="" data-path="readData.html"><a href="readData.html"><i class="fa fa-check"></i>データの読み込み</a></li>
<li class="chapter" data-level="" data-path="normalization.html"><a href="normalization.html"><i class="fa fa-check"></i>データの整形</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#tidyverse-%E3%81%AE%E6%B4%BB%E7%94%A8"><i class="fa fa-check"></i>tidyverse の活用</a></li>
<li class="chapter" data-level="" data-path="normalization.html"><a href="normalization.html#firmdata"><i class="fa fa-check"></i>企業データの処理</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i>データの要約と可視化</a>
<ul>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html#descriptiveStat"><i class="fa fa-check"></i>記述統計</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="categoricalVar.html"><a href="categoricalVar.html"><i class="fa fa-check"></i>カテゴリ変数の要約</a></li>
<li class="chapter" data-level="" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i>データの可視化</a></li>
<li class="chapter" data-level="" data-path="cor.html"><a href="cor.html"><i class="fa fa-check"></i>二変数間の関係の要約</a></li>
<li class="chapter" data-level="" data-path="ch3reference.html"><a href="ch3reference.html"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="test.html"><a href="test.html"><i class="fa fa-check"></i>基礎統計学復習</a>
<ul>
<li class="chapter" data-level="" data-path="ch4Intro.html"><a href="ch4Intro.html"><i class="fa fa-check"></i>本章の概要</a></li>
<li class="chapter" data-level="" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i>確率モデル、期待値と分散</a>
<ul>
<li class="chapter" data-level="" data-path="probability.html"><a href="probability.html#discrete"><i class="fa fa-check"></i>確率と離散確率変数</a></li>
<li class="chapter" data-level="" data-path="probability.html"><a href="probability.html#continuous"><i class="fa fa-check"></i>連続確率変数</a></li>
<li class="chapter" data-level="" data-path="probability.html"><a href="probability.html#expectation"><i class="fa fa-check"></i>期待値</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i>統計的推測</a></li>
<li class="chapter" data-level="" data-path="pestimate.html"><a href="pestimate.html"><i class="fa fa-check"></i>点推定</a></li>
<li class="chapter" data-level="" data-path="estimates.html"><a href="estimates.html"><i class="fa fa-check"></i>推定量もまた確率変数</a></li>
<li class="chapter" data-level="" data-path="distribution.html"><a href="distribution.html"><i class="fa fa-check"></i>補足（いくつかの確率分布の関係性）</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83"><i class="fa fa-check"></i>正規分布</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E3%82%AB%E3%82%A4%E4%BA%8C%E4%B9%97%E5%88%86%E5%B8%83"><i class="fa fa-check"></i>カイ二乗分布</a></li>
<li class="chapter" data-level="" data-path=""><a href="#t%E5%88%86%E5%B8%83"><i class="fa fa-check"></i>t分布</a></li>
<li class="chapter" data-level="" data-path=""><a href="#f%E5%88%86%E5%B8%83"><i class="fa fa-check"></i>F分布</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intinf.html"><a href="intinf.html"><i class="fa fa-check"></i>区間推定</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#%E6%A8%99%E6%BA%96%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83%E3%81%AB%E5%9F%BA%E3%81%A5%E3%81%8F%E4%BF%A1%E9%A0%BC%E5%8C%BA%E9%96%93%E3%81%AE%E6%B1%82%E3%82%81%E6%96%B9"><i class="fa fa-check"></i>標準正規分布に基づく信頼区間の求め方*</a></li>
<li class="chapter" data-level="" data-path=""><a href="#t%E5%88%86%E5%B8%83%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%9F%E5%8C%BA%E9%96%93%E6%8E%A8%E5%AE%9A"><i class="fa fa-check"></i>t分布を使った区間推定*</a></li>
<li class="chapter" data-level="" data-path="intinf.html"><a href="intinf.html#infwithR"><i class="fa fa-check"></i>Rによる区間推定</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="testtheory.html"><a href="testtheory.html"><i class="fa fa-check"></i>統計的仮説検定</a>
<ul>
<li class="chapter" data-level="" data-path="testtheory.html"><a href="testtheory.html#nullhypo"><i class="fa fa-check"></i>検定の手順と仮説</a></li>
<li class="chapter" data-level="" data-path="testtheory.html"><a href="testtheory.html#twotail"><i class="fa fa-check"></i>母平均の検定（両側検定）に関する理屈</a></li>
<li class="chapter" data-level="" data-path="testtheory.html"><a href="testtheory.html#onetail"><i class="fa fa-check"></i>片側検定の紹介</a></li>
<li class="chapter" data-level="" data-path="testtheory.html"><a href="testtheory.html#errors"><i class="fa fa-check"></i>有意水準と検定における誤り</a></li>
<li class="chapter" data-level="" data-path="testtheory.html"><a href="testtheory.html#testresults"><i class="fa fa-check"></i>検定結果に関する解釈</a></li>
<li class="chapter" data-level="" data-path="testtheory.html"><a href="testtheory.html#lightbulb"><i class="fa fa-check"></i>電球データと検定</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="meancomparison.html"><a href="meancomparison.html"><i class="fa fa-check"></i>平均値に関するその他の検定</a></li>
<li class="chapter" data-level="" data-path="ANOVA.html"><a href="ANOVA.html"><i class="fa fa-check"></i>分散分析</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#%E5%88%86%E6%95%A3%E5%88%86%E6%9E%90%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6%E3%81%AE%E3%83%A2%E3%83%87%E3%83%AB%E8%A1%A8%E7%8F%BEanoatheory"><i class="fa fa-check"></i>分散分析についてのモデル表現*{#ANOAtheory}</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E4%BA%8C%E5%85%83%E9%85%8D%E7%BD%AE%E5%88%86%E6%95%A3%E5%88%86%E6%9E%90twowayanoa"><i class="fa fa-check"></i>二元配置分散分析*{#twowayANOA}</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E4%BA%8C%E5%85%83%E9%85%8D%E7%BD%AE%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E5%8A%B9%E6%9E%9C%E6%A4%9C%E5%AE%9Atwowaytest"><i class="fa fa-check"></i>二元配置モデルの効果検定*{#twowaytest}</a></li>
<li class="chapter" data-level="" data-path="ANOVA.html"><a href="ANOVA.html#tukey"><i class="fa fa-check"></i>多重比較とそれに伴う統計的問題</a></li>
<li class="chapter" data-level="" data-path="ANOVA.html"><a href="ANOVA.html#ANOVAwithR"><i class="fa fa-check"></i>Rによる分散分析の実行</a></li>
<li class="chapter" data-level="" data-path="ANOVA.html"><a href="ANOVA.html#ANOVAandReg"><i class="fa fa-check"></i>回帰分析と分散分析の関係</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pwr.html"><a href="pwr.html"><i class="fa fa-check"></i>検定力分析とサンプルサイズ</a></li>
<li class="chapter" data-level="" data-path="ch4reference.html"><a href="ch4reference.html"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="regintro.html"><a href="regintro.html"><i class="fa fa-check"></i>回帰分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch5Intro.html"><a href="ch5Intro.html"><i class="fa fa-check"></i>本章の概要</a></li>
<li class="chapter" data-level="" data-path="regpreparation.html"><a href="regpreparation.html"><i class="fa fa-check"></i>分析準備</a></li>
<li class="chapter" data-level="" data-path="prediction.html"><a href="prediction.html"><i class="fa fa-check"></i>単回帰モデルと予測値</a>
<ul>
<li class="chapter" data-level="" data-path="prediction.html"><a href="prediction.html#lmmodel"><i class="fa fa-check"></i>企業データを用いた回帰分析の実行</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multiplereg.html"><a href="multiplereg.html"><i class="fa fa-check"></i>重回帰モデル</a>
<ul>
<li class="chapter" data-level="" data-path="multiplereg.html"><a href="multiplereg.html#mregIntro"><i class="fa fa-check"></i>重回帰モデル概要</a></li>
<li class="chapter" data-level="" data-path="multiplereg.html"><a href="multiplereg.html#mreginterpret"><i class="fa fa-check"></i>回帰係数の解釈</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="modelcomp.html"><a href="modelcomp.html"><i class="fa fa-check"></i>単回帰モデルと重回帰モデルの比較</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="regtechnic.html"><a href="regtechnic.html"><i class="fa fa-check"></i>回帰分析上の工夫紹介</a>
<ul>
<li class="chapter" data-level="" data-path="ch6Intro.html"><a href="ch6Intro.html"><i class="fa fa-check"></i>本章の概要</a></li>
<li class="chapter" data-level="" data-path="dummy.html"><a href="dummy.html"><i class="fa fa-check"></i>ダミー変数</a>
<ul>
<li class="chapter" data-level="" data-path="dummy.html"><a href="dummy.html#dummywithR"><i class="fa fa-check"></i>企業データを用いた分析の実行</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="interaction.html"><a href="interaction.html"><i class="fa fa-check"></i>交差項</a>
<ul>
<li class="chapter" data-level="" data-path="interaction.html"><a href="interaction.html#slopedummy"><i class="fa fa-check"></i>傾きダミー</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E5%82%BE%E3%81%8D%E3%83%80%E3%83%9F%E3%83%BC%E3%81%AE%E5%AE%9F%E8%A1%8Cslopedummywithr"><i class="fa fa-check"></i>傾きダミーの実行{slopedummywithR}</a></li>
<li class="chapter" data-level="" data-path="interaction.html"><a href="interaction.html#id_5"><i class="fa fa-check"></i>量的変数同士の交差項</a></li>
<li class="chapter" data-level="" data-path="interaction.html"><a href="interaction.html#interactionwithR"><i class="fa fa-check"></i>交差項モデルの実行</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="coefComparison.html"><a href="coefComparison.html"><i class="fa fa-check"></i>係数比較</a>
<ul>
<li class="chapter" data-level="" data-path="coefComparison.html"><a href="coefComparison.html#coefComparisonwithR"><i class="fa fa-check"></i>係数比較の実行</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="logLinearModel.html"><a href="logLinearModel.html"><i class="fa fa-check"></i>対数線形</a>
<ul>
<li class="chapter" data-level="" data-path="logLinearModel.html"><a href="logLinearModel.html#logLinearwithR"><i class="fa fa-check"></i>対数線形モデルの分析実行</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E9%9C%80%E8%A6%81%E3%81%AE%E4%BE%A1%E6%A0%BC%E5%BC%BE%E5%8A%9B%E6%80%A7%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6elasticity"><i class="fa fa-check"></i>需要の価格弾力性について*{#elasticity}</a></li>
<li class="chapter" data-level="" data-path="logLinearModel.html"><a href="logLinearModel.html#linearTest"><i class="fa fa-check"></i>対数線形の推定と検定</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch6Reference.html"><a href="ch6Reference.html"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="choice.html"><a href="choice.html"><i class="fa fa-check"></i>消費者の選択と離散選択モデル</a>
<ul>
<li class="chapter" data-level="" data-path="Ch7Intro.html"><a href="Ch7Intro.html"><i class="fa fa-check"></i>本章の概要</a></li>
<li class="chapter" data-level="" data-path="discretechoice.html"><a href="discretechoice.html"><i class="fa fa-check"></i>離散選択モデル</a>
<ul>
<li class="chapter" data-level="" data-path="discretechoice.html"><a href="discretechoice.html#lpm"><i class="fa fa-check"></i>線形確率モデル</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E3%83%97%E3%83%AD%E3%83%93%E3%83%83%E3%83%88%E3%83%A2%E3%83%87%E3%83%AB%E3%81%A8%E3%83%AD%E3%82%B8%E3%83%83%E3%83%88%E3%83%A2%E3%83%87%E3%83%ABlogitprobit"><i class="fa fa-check"></i>プロビットモデルとロジットモデル*{#logitprobit}</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E6%BD%9C%E5%9C%A8%E5%A4%89%E6%95%B0%E3%82%A2%E3%83%97%E3%83%AD%E3%83%BC%E3%83%81%E3%81%AB%E3%82%88%E3%82%8B%E8%AA%AC%E6%98%8Elatentapproach"><i class="fa fa-check"></i>潜在変数アプローチによる説明*{#latentApproach}</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probitwithR.html"><a href="probitwithR.html"><i class="fa fa-check"></i>プロビットモデルの推定と解釈</a>
<ul>
<li class="chapter" data-level="" data-path="probitwithR.html"><a href="probitwithR.html#probitSummary"><i class="fa fa-check"></i>分析の実行と結果のまとめ</a></li>
<li class="chapter" data-level="" data-path="probitwithR.html"><a href="probitwithR.html#marginaleffectwithR"><i class="fa fa-check"></i>限界効果の計算</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E9%99%90%E7%95%8C%E5%8A%B9%E6%9E%9C%E3%81%8C%E3%81%AA%E3%81%9C%E5%BF%85%E8%A6%81%E3%81%8Bwhymarginal"><i class="fa fa-check"></i>限界効果がなぜ必要か？*{#whymarginal}</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ml.html"><a href="ml.html"><i class="fa fa-check"></i>補足：最尤推定法の紹介</a></li>
<li class="chapter" data-level="" data-path="Mcfadden.html"><a href="Mcfadden.html"><i class="fa fa-check"></i>離散選択モデルへの合理的消費者像の応用</a></li>
<li class="chapter" data-level="" data-path="mlogit.html"><a href="mlogit.html"><i class="fa fa-check"></i>多項選択モデル紹介</a></li>
<li class="chapter" data-level="" data-path="choiceAndPrediction.html"><a href="choiceAndPrediction.html"><i class="fa fa-check"></i>需要の予測と本章のまとめ</a></li>
<li class="chapter" data-level="" data-path="Ch7Reference.html"><a href="Ch7Reference.html"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">マーケティング・データ分析補足資料</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="probitwithR" class="section level2 hasAnchor">
<h2>プロビットモデルの推定と解釈<a href="probitwithR.html#probitwithR" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="probitSummary" class="section level3 hasAnchor">
<h3>分析の実行と結果のまとめ<a href="probitwithR.html#probitSummary" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>プロビットモデルを構築できたら、次はモデル内のパラメータに関する推定値（<span class="math inline">\(\hat{\beta}_0, \hat{\beta}_1,...,\hat{\beta}_k\)</span>）を求め、選択確率に関する含意を得る。プロビットモデルのパラメータ推定においては、最小二乗法ではなく、最尤（Maximum Likelihood: ML）法を用いるが、詳細については補足（<a href="ml.html#ml"><strong>??</strong></a>）を参照してほしい。</p>
<p>プロビットモデルを推定する場合のデータセットには、説明変数に関する列（<span class="math inline">\(x_{1i},.., x_{ki}\)</span>）と、それに対応する個人 <span class="math inline">\(i\)</span> の選択結果 <span class="math inline">\(y_i\)</span>（選択していれば1、選択していなければ 0）が記録されている。<code>choice_data.xlsx</code> は、二つの製品に対する消費者の選択結果を捉えた人工データセットである。データには製品1の価格 <span class="math inline">\(p1\)</span>、製品2の価格 <span class="math inline">\(p2\)</span>（千円）、製品1のクーポン広告を受け取ったかのダミー変数 <span class="math inline">\(a1\)</span>、製品2のクーポン広告ダミー変数 <span class="math inline">\(a2\)</span> と、製品1の選択結果 <span class="math inline">\(y1\)</span>、製品2の選択結果 <span class="math inline">\(y2\)</span> が含まれている。</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="probitwithR.html#cb222-1" tabindex="-1"></a>choice_df <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(<span class="st">&quot;data/choice_data.xlsx&quot;</span>)</span>
<span id="cb222-2"><a href="probitwithR.html#cb222-2" tabindex="-1"></a><span class="fu">head</span>(choice_df)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 6
##      y1    y2    p1    p2    a1    a2
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1     0 10.7  16.8      0     1
## 2     0     1 11.6   9.15     1     0
## 3     1     0  8.97  9.31     1     0
## 4     1     0  4.62  8.03     0     0
## 5     1     0  7.81 19.2      1     1
## 6     1     0  7.49  8.84     0     0</code></pre>
<p>この<code>choice_data.xlsx</code>を用いて製品1の選択に関するプロビットモデルを推定してみる。Rでは<code>glm()</code>関数において、<code>family = binomial(link = probit)</code> という引数を指定することで実行が可能である<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a>。以下では分析の実行と結果の出力を行う。</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="probitwithR.html#cb224-1" tabindex="-1"></a>probit1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y1 <span class="sc">~</span> p1 <span class="sc">+</span> a1, </span>
<span id="cb224-2"><a href="probitwithR.html#cb224-2" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> probit),</span>
<span id="cb224-3"><a href="probitwithR.html#cb224-3" tabindex="-1"></a>               <span class="at">data =</span> choice_df)</span>
<span id="cb224-4"><a href="probitwithR.html#cb224-4" tabindex="-1"></a><span class="fu">summary</span>(probit1)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = y1 ~ p1 + a1, family = binomial(link = probit), 
##     data = choice_df)
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  2.04117    0.22350   9.133  &lt; 2e-16 ***
## p1          -0.24720    0.02213 -11.171  &lt; 2e-16 ***
## a1           0.62763    0.08656   7.251 4.13e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1384.5  on 999  degrees of freedom
## Residual deviance: 1205.5  on 997  degrees of freedom
## AIC: 1211.5
## 
## Number of Fisher Scoring iterations: 3</code></pre>
<p>ここまで、我々は線形確率、プロビット、ロジットという3種類のモデルでの推定方法を概観してきた。以下では、これらの異なる推定方法を用いた分析結果を併記する。</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="probitwithR.html#cb226-1" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb226-2"><a href="probitwithR.html#cb226-2" tabindex="-1"></a>ols1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y1 <span class="sc">~</span> p1 <span class="sc">+</span> a1, </span>
<span id="cb226-3"><a href="probitwithR.html#cb226-3" tabindex="-1"></a>               <span class="at">data =</span> choice_df)</span>
<span id="cb226-4"><a href="probitwithR.html#cb226-4" tabindex="-1"></a></span>
<span id="cb226-5"><a href="probitwithR.html#cb226-5" tabindex="-1"></a>logit1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y1 <span class="sc">~</span> p1 <span class="sc">+</span> a1, </span>
<span id="cb226-6"><a href="probitwithR.html#cb226-6" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit),</span>
<span id="cb226-7"><a href="probitwithR.html#cb226-7" tabindex="-1"></a>               <span class="at">data =</span> choice_df)</span>
<span id="cb226-8"><a href="probitwithR.html#cb226-8" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>() </span>
<span id="cb226-9"><a href="probitwithR.html#cb226-9" tabindex="-1"></a>models[[<span class="st">&quot;Linear probability model&quot;</span>]] <span class="ot">&lt;-</span> ols1</span>
<span id="cb226-10"><a href="probitwithR.html#cb226-10" tabindex="-1"></a>models[[<span class="st">&quot;Probit model&quot;</span>]] <span class="ot">&lt;-</span> probit1</span>
<span id="cb226-11"><a href="probitwithR.html#cb226-11" tabindex="-1"></a>models[[<span class="st">&quot;Logit model&quot;</span>]] <span class="ot">&lt;-</span> logit1</span>
<span id="cb226-12"><a href="probitwithR.html#cb226-12" tabindex="-1"></a></span>
<span id="cb226-13"><a href="probitwithR.html#cb226-13" tabindex="-1"></a><span class="fu">modelsummary</span>(models, </span>
<span id="cb226-14"><a href="probitwithR.html#cb226-14" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">&quot;モデル比較&quot;</span>,</span>
<span id="cb226-15"><a href="probitwithR.html#cb226-15" tabindex="-1"></a>         <span class="at">notes =</span> <span class="st">&quot;Values in [ ] show robust standard errors&quot;</span>,</span>
<span id="cb226-16"><a href="probitwithR.html#cb226-16" tabindex="-1"></a>         <span class="at">stars =</span> <span class="cn">TRUE</span>, </span>
<span id="cb226-17"><a href="probitwithR.html#cb226-17" tabindex="-1"></a>         <span class="at">statistic =</span> <span class="st">&quot;std.error&quot;</span>,</span>
<span id="cb226-18"><a href="probitwithR.html#cb226-18" tabindex="-1"></a>         <span class="at">vcov =</span> <span class="st">&quot;robust&quot;</span>,</span>
<span id="cb226-19"><a href="probitwithR.html#cb226-19" tabindex="-1"></a>         <span class="at">gof_map =</span> <span class="st">&quot;nobs&quot;</span>) <span class="co">#適合度指標において、サンプルサイズ（&quot;nobs&quot;）のみ表示するという指示</span></span></code></pre></div>
<!-- preamble start -->

    <script>

      function styleCell_zihfgd4vfohjh1bh0oaa(i, j, css_id) {
          var table = document.getElementById("tinytable_zihfgd4vfohjh1bh0oaa");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_zihfgd4vfohjh1bh0oaa');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_zihfgd4vfohjh1bh0oaa(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_zihfgd4vfohjh1bh0oaa");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 7, j: 1 }, { i: 7, j: 2 }, { i: 7, j: 3 },  ], css_id: 'tinytable_css_tj85cuepflj3e4wpb130',}, 
          { positions: [ { i: 6, j: 1 }, { i: 6, j: 2 }, { i: 6, j: 3 },  ], css_id: 'tinytable_css_izqd5l5620pvep1kz51p',}, 
          { positions: [ { i: 1, j: 1 }, { i: 2, j: 1 }, { i: 3, j: 1 }, { i: 5, j: 1 }, { i: 2, j: 2 }, { i: 3, j: 2 }, { i: 1, j: 2 }, { i: 2, j: 3 }, { i: 3, j: 3 }, { i: 4, j: 1 }, { i: 5, j: 2 }, { i: 4, j: 2 }, { i: 1, j: 3 }, { i: 4, j: 3 }, { i: 5, j: 3 },  ], css_id: 'tinytable_css_k0le9pcpaiqdgnv8witb',}, 
          { positions: [ { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_jqhrqjkjpxiz71ifhzpt',}, 
          { positions: [ { i: 7, j: 0 },  ], css_id: 'tinytable_css_78kqby0lbvpm1jil2zqy',}, 
          { positions: [ { i: 6, j: 0 },  ], css_id: 'tinytable_css_9m97w0wfum5edyyrgadx',}, 
          { positions: [ { i: 1, j: 0 }, { i: 2, j: 0 }, { i: 3, j: 0 }, { i: 4, j: 0 }, { i: 5, j: 0 },  ], css_id: 'tinytable_css_mpwuxgrf7hviu6mig11r',}, 
          { positions: [ { i: 0, j: 0 },  ], css_id: 'tinytable_css_g17hdk462kclif48qmcr',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_zihfgd4vfohjh1bh0oaa(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_tj85cuepflj3e4wpb130, .table th.tinytable_css_tj85cuepflj3e4wpb130 { text-align: center; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_izqd5l5620pvep1kz51p, .table th.tinytable_css_izqd5l5620pvep1kz51p { text-align: center; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_k0le9pcpaiqdgnv8witb, .table th.tinytable_css_k0le9pcpaiqdgnv8witb { text-align: center; }
      .table td.tinytable_css_jqhrqjkjpxiz71ifhzpt, .table th.tinytable_css_jqhrqjkjpxiz71ifhzpt { text-align: center; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_78kqby0lbvpm1jil2zqy, .table th.tinytable_css_78kqby0lbvpm1jil2zqy { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_9m97w0wfum5edyyrgadx, .table th.tinytable_css_9m97w0wfum5edyyrgadx { text-align: left; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_mpwuxgrf7hviu6mig11r, .table th.tinytable_css_mpwuxgrf7hviu6mig11r { text-align: left; }
      .table td.tinytable_css_g17hdk462kclif48qmcr, .table th.tinytable_css_g17hdk462kclif48qmcr { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_zihfgd4vfohjh1bh0oaa" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing='true'>
        <thead>
        <caption>モデル比較</caption>
              <tr>
                <th scope="col"> </th>
                <th scope="col">Linear probability model</th>
                <th scope="col">Probit model</th>
                <th scope="col">Logit model</th>
              </tr>
        </thead>
        <tfoot><tr><td colspan='4'>+ p < 0.1, * p < 0.05, ** p < 0.01, *** p < 0.001</td></tr>
<tr><td colspan='4'>Values in [ ] show robust standard errors</td></tr></tfoot>
        <tbody>
                <tr>
                  <td>(Intercept)</td>
                  <td>1.196***</td>
                  <td>2.041***</td>
                  <td>3.332***</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(0.065)</td>
                  <td>(0.212)</td>
                  <td>(0.361)</td>
                </tr>
                <tr>
                  <td>p1</td>
                  <td>-0.085***</td>
                  <td>-0.247***</td>
                  <td>-0.404***</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(0.006)</td>
                  <td>(0.021)</td>
                  <td>(0.036)</td>
                </tr>
                <tr>
                  <td>a1</td>
                  <td>0.221***</td>
                  <td>0.628***</td>
                  <td>1.035***</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(0.029)</td>
                  <td>(0.087)</td>
                  <td>(0.145)</td>
                </tr>
                <tr>
                  <td>Num.Obs.</td>
                  <td>1000</td>
                  <td>1000</td>
                  <td>1000</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
<p>分析の結果、推定値の違いはあるものの、どのアプローチでも <code>p1</code> は被説明変数に対して負に、<code>a1</code> は正に有意な影響を与えることが示されている。しかしながら、詳しくは次項にて説明するが、係数の解釈については注意が必要である。前章で紹介した <code>modelsummary</code> パッケージを使えば、複数の分析アプローチを用いた結果をまとめ、併記することも簡単である。結果の頑健性チェックや、様々な比較検討のために、このような表が用いられることも多い。</p>
</div>
<div id="marginaleffectwithR" class="section level3 hasAnchor">
<h3>限界効果の計算<a href="probitwithR.html#marginaleffectwithR" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>プロビットモデルの分析には成功したが、非線形モデルで推定された係数の解釈には注意が必要である。特に、プロビットモデルによって推定されたある変数の係数値は、「他の変数の影響をコントロールした場合にその変数が選択確率に与える影響」を意味しない。そのため、OLSの分析結果のように、係数の推定値のみを見て変数の影響の程度を議論することはできず、そのような解釈を行うためには特定の変数が持つ「限界効果」を追加的に分析する必要がある。限界効果の必要性や、平均的な限界効果、個別限界効果の平均値については次節で説明を加えている。</p>
<p>限界効果の計算には、<code>mfx::probitmfx()</code> を用いる<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a>ため、以下のようにパッケージをインストールしてほしい。</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="probitwithR.html#cb227-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;mfx&quot;</span>)</span></code></pre></div>
<p><code>mfx</code> パッケージを用いた限界効果の計算では、線形モデルやプロビットモデルの推定同様、以下のようにモデルを指定し、分析を行う。平均的な限界効果の計算方法については、<code>atmean</code> という引数で指定する。<code>atmean = FALSE</code> とすることで、個別限界効果の平均値を計算できる。個別限界効果の平均値とは、データ内の個人の個別限界効果を計算し、その平均値求める方法である。一方で、平均値における限界効果は<code>atmean = TRUE</code> と指示することで計算できる。平均値における限界効果は、モデル内の説明変数の値について、それぞれ平均値を計算し、そのうえで限界効果を求める方法である。</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="probitwithR.html#cb228-1" tabindex="-1"></a><span class="fu">library</span>(mfx)</span>
<span id="cb228-2"><a href="probitwithR.html#cb228-2" tabindex="-1"></a><span class="co">#Average Marginal Effects (限界効果の平均)</span></span>
<span id="cb228-3"><a href="probitwithR.html#cb228-3" tabindex="-1"></a>probit1_ame <span class="ot">&lt;-</span> <span class="fu">probitmfx</span>(y1 <span class="sc">~</span> p1 <span class="sc">+</span> a1,</span>
<span id="cb228-4"><a href="probitwithR.html#cb228-4" tabindex="-1"></a>               <span class="at">data =</span> choice_df, <span class="at">atmean =</span> <span class="cn">FALSE</span>)</span>
<span id="cb228-5"><a href="probitwithR.html#cb228-5" tabindex="-1"></a>probit1_ame</span></code></pre></div>
<pre><code>## Call:
## probitmfx(formula = y1 ~ p1 + a1, data = choice_df, atmean = FALSE)
## 
## Marginal Effects:
##         dF/dx  Std. Err.        z     P&gt;|z|    
## p1 -0.0847786  0.0060787 -13.9469 &lt; 2.2e-16 ***
## a1  0.2188866  0.0289816   7.5526 4.266e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## dF/dx is for discrete change for the following variables:
## 
## [1] &quot;a1&quot;</code></pre>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="probitwithR.html#cb230-1" tabindex="-1"></a><span class="co">#Marginal Effects at Mean（平均値における限界効果）</span></span>
<span id="cb230-2"><a href="probitwithR.html#cb230-2" tabindex="-1"></a>probit1_mem <span class="ot">&lt;-</span> <span class="fu">probitmfx</span>(y1 <span class="sc">~</span> p1 <span class="sc">+</span> a1,</span>
<span id="cb230-3"><a href="probitwithR.html#cb230-3" tabindex="-1"></a>               <span class="at">data =</span> choice_df, <span class="at">atmean =</span> <span class="cn">TRUE</span>)</span>
<span id="cb230-4"><a href="probitwithR.html#cb230-4" tabindex="-1"></a>probit1_mem</span></code></pre></div>
<pre><code>## Call:
## probitmfx(formula = y1 ~ p1 + a1, data = choice_df, atmean = TRUE)
## 
## Marginal Effects:
##         dF/dx  Std. Err.        z     P&gt;|z|    
## p1 -0.0984235  0.0088074 -11.1750 &lt; 2.2e-16 ***
## a1  0.2446609  0.0324366   7.5427 4.602e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## dF/dx is for discrete change for the following variables:
## 
## [1] &quot;a1&quot;</code></pre>
<p>分析結果を比較すると、多少計算結果は異なるものの、どちらの計算方法においても、価格は製品の選択確率に負に、クーポンは正に有意な影響を与えることが伺える。また影響の程度として、限界効果の平均値に着目すると、価格が1単位（千円）上昇すると、選択確率が約<span class="math inline">\(8.5\%\)</span>下がること、クーポンを受け取った人は受け取っていない人と比べて約<span class="math inline">\(21.9\%\)</span>選択確率が高いことが伺える。なお、詳細については省略するが限界効果の標準誤差はデルタ法と呼ばれる方法で計算されている（Fernihough, 2019）。</p>
<p>また、<code>mfx</code> による結果も以下のように整理して出力する事ができる。下表の(1) は限界効果の平均（Average Mean Effect）、(2) は平均的個人における限界効果（Marginal Effect at Mean）をそれぞれあらわしている。</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="probitwithR.html#cb232-1" tabindex="-1"></a>marginal <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb232-2"><a href="probitwithR.html#cb232-2" tabindex="-1"></a>  <span class="st">&quot;p1 marginal&quot;</span> <span class="ot">=</span> <span class="st">&quot;p1&quot;</span>,</span>
<span id="cb232-3"><a href="probitwithR.html#cb232-3" tabindex="-1"></a>  <span class="st">&quot;a1 marginal&quot;</span> <span class="ot">=</span> <span class="st">&quot;a1&quot;</span></span>
<span id="cb232-4"><a href="probitwithR.html#cb232-4" tabindex="-1"></a>)</span>
<span id="cb232-5"><a href="probitwithR.html#cb232-5" tabindex="-1"></a></span>
<span id="cb232-6"><a href="probitwithR.html#cb232-6" tabindex="-1"></a>marg_model <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb232-7"><a href="probitwithR.html#cb232-7" tabindex="-1"></a>  <span class="st">&quot;(1) Probit_AME&quot;</span> <span class="ot">&lt;-</span> probit1_ame,</span>
<span id="cb232-8"><a href="probitwithR.html#cb232-8" tabindex="-1"></a>  <span class="st">&quot;(2) Probit_MEM&quot;</span> <span class="ot">&lt;-</span> probit1_mem</span>
<span id="cb232-9"><a href="probitwithR.html#cb232-9" tabindex="-1"></a>)</span>
<span id="cb232-10"><a href="probitwithR.html#cb232-10" tabindex="-1"></a>marg_sum <span class="ot">&lt;-</span> <span class="fu">modelsummary</span>(</span>
<span id="cb232-11"><a href="probitwithR.html#cb232-11" tabindex="-1"></a>  <span class="co"># models to summarize side-by-side</span></span>
<span id="cb232-12"><a href="probitwithR.html#cb232-12" tabindex="-1"></a>  marg_model,</span>
<span id="cb232-13"><a href="probitwithR.html#cb232-13" tabindex="-1"></a>  <span class="co"># S.E. in parentheses</span></span>
<span id="cb232-14"><a href="probitwithR.html#cb232-14" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="st">&quot;std.error&quot;</span>,</span>
<span id="cb232-15"><a href="probitwithR.html#cb232-15" tabindex="-1"></a>  <span class="co"># rename and select the coefficients</span></span>
<span id="cb232-16"><a href="probitwithR.html#cb232-16" tabindex="-1"></a>  <span class="at">coef_map =</span> marginal,</span>
<span id="cb232-17"><a href="probitwithR.html#cb232-17" tabindex="-1"></a>  <span class="co"># significance stars</span></span>
<span id="cb232-18"><a href="probitwithR.html#cb232-18" tabindex="-1"></a>  <span class="at">stars =</span> <span class="cn">TRUE</span>,</span>
<span id="cb232-19"><a href="probitwithR.html#cb232-19" tabindex="-1"></a>  <span class="co"># term and component columns are combined</span></span>
<span id="cb232-20"><a href="probitwithR.html#cb232-20" tabindex="-1"></a>  <span class="at">shape =</span> term<span class="sc">:</span>component <span class="sc">~</span> model,</span>
<span id="cb232-21"><a href="probitwithR.html#cb232-21" tabindex="-1"></a>  <span class="at">add_rows =</span> <span class="fu">data.frame</span>(<span class="st">&quot;Marginal effect type&quot;</span>, <span class="st">&quot;Average Marginal Effect&quot;</span>, <span class="st">&quot;Marginal Effect at Mean&quot;</span>),</span>
<span id="cb232-22"><a href="probitwithR.html#cb232-22" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;限界効果サマリー&quot;</span>,</span>
<span id="cb232-23"><a href="probitwithR.html#cb232-23" tabindex="-1"></a>  <span class="co"># omit all goodness-of-fit statisitcs except # of observations</span></span>
<span id="cb232-24"><a href="probitwithR.html#cb232-24" tabindex="-1"></a>  <span class="at">gof_map =</span> <span class="st">&quot;nobs&quot;</span>)</span>
<span id="cb232-25"><a href="probitwithR.html#cb232-25" tabindex="-1"></a>marg_sum</span></code></pre></div>
<!-- preamble start -->

    <script>

      function styleCell_hzjywckysgeirh809w8j(i, j, css_id) {
          var table = document.getElementById("tinytable_hzjywckysgeirh809w8j");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_hzjywckysgeirh809w8j');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_hzjywckysgeirh809w8j(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_hzjywckysgeirh809w8j");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 6, j: 1 }, { i: 6, j: 2 },  ], css_id: 'tinytable_css_yelne0lcir1sutp3bbno',}, 
          { positions: [ { i: 4, j: 2 }, { i: 4, j: 1 },  ], css_id: 'tinytable_css_yokglx63b0x6ls3phg1e',}, 
          { positions: [ { i: 1, j: 1 }, { i: 2, j: 1 }, { i: 1, j: 2 }, { i: 5, j: 1 }, { i: 3, j: 2 }, { i: 3, j: 1 }, { i: 5, j: 2 }, { i: 2, j: 2 },  ], css_id: 'tinytable_css_uvth36cm3k07kvbq3o1r',}, 
          { positions: [ { i: 0, j: 1 }, { i: 0, j: 2 },  ], css_id: 'tinytable_css_n9jvwxp7k94v053idglp',}, 
          { positions: [ { i: 6, j: 0 },  ], css_id: 'tinytable_css_6q7mbmydjmondiukvelc',}, 
          { positions: [ { i: 4, j: 0 },  ], css_id: 'tinytable_css_u0s0ag5tevlf6xxpw152',}, 
          { positions: [ { i: 1, j: 0 }, { i: 2, j: 0 }, { i: 3, j: 0 }, { i: 5, j: 0 },  ], css_id: 'tinytable_css_kij97j4dlfkjejq7245i',}, 
          { positions: [ { i: 0, j: 0 },  ], css_id: 'tinytable_css_s44182h41acyy5ngfike',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_hzjywckysgeirh809w8j(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_yelne0lcir1sutp3bbno, .table th.tinytable_css_yelne0lcir1sutp3bbno { text-align: center; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_yokglx63b0x6ls3phg1e, .table th.tinytable_css_yokglx63b0x6ls3phg1e { text-align: center; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_uvth36cm3k07kvbq3o1r, .table th.tinytable_css_uvth36cm3k07kvbq3o1r { text-align: center; }
      .table td.tinytable_css_n9jvwxp7k94v053idglp, .table th.tinytable_css_n9jvwxp7k94v053idglp { text-align: center; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_6q7mbmydjmondiukvelc, .table th.tinytable_css_6q7mbmydjmondiukvelc { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_u0s0ag5tevlf6xxpw152, .table th.tinytable_css_u0s0ag5tevlf6xxpw152 { text-align: left; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_kij97j4dlfkjejq7245i, .table th.tinytable_css_kij97j4dlfkjejq7245i { text-align: left; }
      .table td.tinytable_css_s44182h41acyy5ngfike, .table th.tinytable_css_s44182h41acyy5ngfike { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_hzjywckysgeirh809w8j" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing='true'>
        <thead>
        <caption>限界効果サマリー</caption>
              <tr>
                <th scope="col"> </th>
                <th scope="col">(1)</th>
                <th scope="col">(2)</th>
              </tr>
        </thead>
        <tfoot><tr><td colspan='3'>+ p < 0.1, * p < 0.05, ** p < 0.01, *** p < 0.001</td></tr></tfoot>
        <tbody>
                <tr>
                  <td>p1</td>
                  <td>-0.085***</td>
                  <td>-0.098***</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(0.006)</td>
                  <td>(0.009)</td>
                </tr>
                <tr>
                  <td>a1</td>
                  <td>0.219***</td>
                  <td>0.245***</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(0.029)</td>
                  <td>(0.032)</td>
                </tr>
                <tr>
                  <td>Num.Obs.</td>
                  <td>1000</td>
                  <td>1000</td>
                </tr>
                <tr>
                  <td>Marginal effect type</td>
                  <td>Average Marginal Effect</td>
                  <td>Marginal Effect at Mean</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
<p>最後に、プロビットモデルのモデル評価指標について紹介する。プロビットモデルを最尤法で推定した場合、OLSにおける決定係数 <span class="math inline">\(R^2\)</span> を用いてモデルの当てはまりの良さを用いることはできない。そこで、通常、疑似決定係数（Pseudo <span class="math inline">\(R^2\)</span>）を用いる事が多い<a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a>。疑似決定係数は0から1の間の値を取り、自身の立てたモデルの当てはまりが良いほど1に近づくという特徴を持っている。Rにおいては、<code>DescTools::PseudoR2()</code> を用いて計算可能である。<code>install.packages("DescTools")</code> でインストールしてほしい。</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="probitwithR.html#cb233-1" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">PseudoR2</span>(probit1)</span></code></pre></div>
<pre><code>##  McFadden 
## 0.1293345</code></pre>
</div>
<div id="限界効果がなぜ必要かwhymarginal" class="section level3 hasAnchor">
<h3>限界効果がなぜ必要か？*{#whymarginal}<a href="#%E9%99%90%E7%95%8C%E5%8A%B9%E6%9E%9C%E3%81%8C%E3%81%AA%E3%81%9C%E5%BF%85%E8%A6%81%E3%81%8Bwhymarginal" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>ここでは、プロビットモデルによって得た係数の推定値を直接的に解釈できない理由と限界効果についての詳細を説明する。パラメータの推定結果と、<span class="math inline">\(x_{1i},...,x_{ki}\)</span> の値を得たときに <span class="math inline">\(y_i\)</span> が 1 を取る確率は以下の様に示される。</p>
<p><span class="math display">\[
\hat{P}(y_i=1|x_{1i},...,x_{ki})=\Phi(\hat{\beta}_0+\hat{\beta}_1x_{1i}+...+\hat{\beta}_kx_{ki})
\]</span></p>
<p>ここで、説明変数 <span class="math inline">\(x_{1i}\)</span> の限界効果は、<span class="math inline">\(x_{1i}\)</span> が変化したときに反応確率がどのように変化するのかを表す。これは偏微分という計算方法を用いて以下の様に示すことができる。なお、以下で示す内容は <span class="math inline">\(x_{1i}\)</span> 以外の任意の説明変数を用いても成り立つ。</p>
<p><span class="math display">\[
\frac{\partial \hat{P}(y_i=1|x_{1i},...,x_{ki})}{\partial x_{1i}}=\phi(\hat{\beta}_0+\hat{\beta}_1x_{1i}+...+\hat{\beta}_kx_{ki})\hat{\beta}_1
\]</span></p>
<p>ただし、<span class="math inline">\(\phi\)</span> は標準正規分布の確率密度関数であり、累積分布関数を微分することで得られる。このように、OLSのような線形モデルと異なり、<span class="math inline">\(\hat{\beta}_1\)</span> が直接的に限界効果を示しているわけではないことが伺える<a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a>。</p>
<p>また同式より、ある変数の変化が反応確率へ与える限界効果は、個人が持つ全ての説明変数（<span class="math inline">\(x_{1i},...,x_{ki}\)</span>）の値によって変化することもわかる。そのため、限界効果の報告においては「平均的な」限界効果を報告することが一般的である。ただし、「何の平均を取るか」という点において、2種類の計算方法が存在する。第1に、個人の個別限界効果を計算し、その平均値求めるという以下のような方法である。</p>
<p><span class="math display" id="eq:avgmarg1">\[\begin{equation}
\frac{1}{n}\sum^n_{i=1}\Big[\phi(\hat{\beta}_0+\hat{\beta}_1x_{1i}+...+\hat{\beta}_kx_{ki})\hat{\beta}_1 \Big] \tag{2}
\end{equation}\]</span></p>
<p>この計算方法は、因果推論における平均処置効果の議論に対応しているという好ましい性質を持っている（西山ほか, 2019）。</p>
<p>第2の方法は、説明変数の値について、それぞれ平均値を計算し、限界効果を求めるという以下のような方法である。</p>
<p><span class="math display" id="eq:avgmarg2">\[\begin{equation}
\phi(\hat{\beta_0}+\hat{\beta}_1\bar{x}_1+...+\hat{\beta}_k\bar{x}_k)\hat{\beta}_1 \tag{3}
\end{equation}\]</span></p>
<p>これは、それぞれの説明変数について平均値を取るような「平均的個人」における限界効果として解釈可能な計算方法である。</p>
<p>着目する説明変数が上のデータ分析結果における <code>a1</code> のように離散変数（ダミー変数）の場合、その限界効果についてこれまでのような偏微分の議論は使えない。そのため、ダミー変数が 0 の場合の反応確率と、1 の場合の反応確率の差を取る形で限界効果を捉える。例えば、クーポンを受け取っていない場合（<span class="math inline">\(a_1=0\)</span>）と受け取った場合（<span class="math inline">\(a_1=1\)</span>）の反応確率の差は以下の様に示すことができる。</p>
<p><span class="math display" id="eq:marg-dummy">\[\begin{equation}
\Phi(\hat{\beta}_0+\hat{\beta}_1p_{1i}+\hat{\beta}_2) - \Phi(\hat{\beta}_0+\hat{\beta}_1p_{1i}) \tag{4}
\end{equation}\]</span></p>
<p>この限界効果も、他の変数の値（例えば、<span class="math inline">\(p_{1i}\)</span>）によって変化するため、連続変数の場合と同様に平均値を報告することが一般的である。</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="14">
<li id="fn14"><p>ロジットモデルの場合は、<code>family = binomial(link = logit)</code> で計算可能である。<a href="probitwithR.html#fnref14" class="footnote-back">↩︎</a></p></li>
<li id="fn15"><p>ロジットモデルの場合は、<code>mfx::logitmfx()</code> で計算可能である。<a href="probitwithR.html#fnref15" class="footnote-back">↩︎</a></p></li>
<li id="fn16"><p>この指標は、最尤推定で用いる対数尤度関数 <a href="ml.html#eq:llprobit">(5)</a> に実際の観測値と最尤推定値を代入して求まる対数尤度の和（<span class="math inline">\(L_{full}\)</span>）と、定数項だけを含むプロビットモデルを推定したときの対数尤度の和（<span class="math inline">\(L_0\)</span>）を用いて、<span class="math inline">\(\Big(1-(L_{full}/L_0) \Big)\)</span> と定義される<a href="probitwithR.html#fnref16" class="footnote-back">↩︎</a></p></li>
<li id="fn17"><p><span class="math inline">\(\hat{y}_i=\hat{\beta}_0+\hat{\beta_1}x_{1i}+...+\hat{\beta}_kx_{ki}\)</span> という線形モデルの限界効果は、以下のようになる。
<span class="math display">\[\frac{\partial \hat{y}_i}{\partial x_{1i}}=\hat{\beta}_1
\]</span><a href="probitwithR.html#fnref17" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="discretechoice.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ml.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/USERNAME/REPO/edit/BRANCH/06-choicemodel.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection",
    "scroll_highlight": true
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
