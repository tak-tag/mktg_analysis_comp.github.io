<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>交差項 | マーケティング・データ分析補足資料</title>
  <meta name="description" content="交差項 | マーケティング・データ分析補足資料" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="交差項 | マーケティング・データ分析補足資料" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="https://github.com/tak-tag/mktg_analysis_comp.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="交差項 | マーケティング・データ分析補足資料" />
  
  
  



<meta name="date" content="2025-11-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dummy.html"/>
<link rel="next" href="coefComparison.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>本ウェブサイトについて</a></li>
<li class="chapter" data-level="" data-path="rusage.html"><a href="rusage.html"><i class="fa fa-check"></i>R と R studioに慣れる</a>
<ul>
<li class="chapter" data-level="" data-path="ch2intro.html"><a href="ch2intro.html"><i class="fa fa-check"></i>本章の概要</a></li>
<li class="chapter" data-level="" data-path="desktop.html"><a href="desktop.html"><i class="fa fa-check"></i>R studio デスクトップ版の利用</a></li>
<li class="chapter" data-level="" data-path="project.html"><a href="project.html"><i class="fa fa-check"></i>プロジェクト機能について</a></li>
<li class="chapter" data-level="" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i>Rの基本操作</a></li>
<li class="chapter" data-level="" data-path="rscript.html"><a href="rscript.html"><i class="fa fa-check"></i>R スクリプトのすゝめ</a>
<ul>
<li class="chapter" data-level="" data-path="rscript.html"><a href="rscript.html#writeRscript"><i class="fa fa-check"></i>Rスクリプトを書く</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch2summary.html"><a href="ch2summary.html"><i class="fa fa-check"></i>本章のまとめ</a></li>
<li class="chapter" data-level="" data-path="positcloud.html"><a href="positcloud.html"><i class="fa fa-check"></i>コラム：Posit cloudを使ってみる</a></li>
<li class="chapter" data-level="" data-path="ch2reference.html"><a href="ch2reference.html"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="handling.html"><a href="handling.html"><i class="fa fa-check"></i>データ整理と要約・可視化</a>
<ul>
<li class="chapter" data-level="" data-path="Ch3intro.html"><a href="Ch3intro.html"><i class="fa fa-check"></i>本章の概要</a></li>
<li class="chapter" data-level="" data-path="readData.html"><a href="readData.html"><i class="fa fa-check"></i>データの読み込み</a></li>
<li class="chapter" data-level="" data-path="normalization.html"><a href="normalization.html"><i class="fa fa-check"></i>データの整形</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#tidyverse-%E3%81%AE%E6%B4%BB%E7%94%A8"><i class="fa fa-check"></i>tidyverse の活用</a></li>
<li class="chapter" data-level="" data-path="normalization.html"><a href="normalization.html#firmdata"><i class="fa fa-check"></i>企業データの処理</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i>データの要約と可視化</a>
<ul>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html#descriptiveStat"><i class="fa fa-check"></i>記述統計</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="categoricalVar.html"><a href="categoricalVar.html"><i class="fa fa-check"></i>カテゴリ変数の要約</a></li>
<li class="chapter" data-level="" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i>データの可視化</a></li>
<li class="chapter" data-level="" data-path="cor.html"><a href="cor.html"><i class="fa fa-check"></i>二変数間の関係の要約</a></li>
<li class="chapter" data-level="" data-path="ch3reference.html"><a href="ch3reference.html"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="test.html"><a href="test.html"><i class="fa fa-check"></i>基礎統計学復習</a>
<ul>
<li class="chapter" data-level="" data-path="ch4Intro.html"><a href="ch4Intro.html"><i class="fa fa-check"></i>本章の概要</a></li>
<li class="chapter" data-level="" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i>確率モデル、期待値と分散</a>
<ul>
<li class="chapter" data-level="" data-path="probability.html"><a href="probability.html#discrete"><i class="fa fa-check"></i>確率と離散確率変数</a></li>
<li class="chapter" data-level="" data-path="probability.html"><a href="probability.html#continuous"><i class="fa fa-check"></i>連続確率変数</a></li>
<li class="chapter" data-level="" data-path="probability.html"><a href="probability.html#expectation"><i class="fa fa-check"></i>期待値</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i>統計的推測</a></li>
<li class="chapter" data-level="" data-path="pestimate.html"><a href="pestimate.html"><i class="fa fa-check"></i>点推定</a></li>
<li class="chapter" data-level="" data-path="estimates.html"><a href="estimates.html"><i class="fa fa-check"></i>推定量もまた確率変数</a></li>
<li class="chapter" data-level="" data-path="distribution.html"><a href="distribution.html"><i class="fa fa-check"></i>補足（いくつかの確率分布の関係性）</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83"><i class="fa fa-check"></i>正規分布</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E3%82%AB%E3%82%A4%E4%BA%8C%E4%B9%97%E5%88%86%E5%B8%83"><i class="fa fa-check"></i>カイ二乗分布</a></li>
<li class="chapter" data-level="" data-path=""><a href="#t%E5%88%86%E5%B8%83"><i class="fa fa-check"></i>t分布</a></li>
<li class="chapter" data-level="" data-path=""><a href="#f%E5%88%86%E5%B8%83"><i class="fa fa-check"></i>F分布</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intinf.html"><a href="intinf.html"><i class="fa fa-check"></i>区間推定</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#%E6%A8%99%E6%BA%96%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83%E3%81%AB%E5%9F%BA%E3%81%A5%E3%81%8F%E4%BF%A1%E9%A0%BC%E5%8C%BA%E9%96%93%E3%81%AE%E6%B1%82%E3%82%81%E6%96%B9"><i class="fa fa-check"></i>標準正規分布に基づく信頼区間の求め方*</a></li>
<li class="chapter" data-level="" data-path=""><a href="#t%E5%88%86%E5%B8%83%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%9F%E5%8C%BA%E9%96%93%E6%8E%A8%E5%AE%9A"><i class="fa fa-check"></i>t分布を使った区間推定*</a></li>
<li class="chapter" data-level="" data-path="intinf.html"><a href="intinf.html#infwithR"><i class="fa fa-check"></i>Rによる区間推定</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="testtheory.html"><a href="testtheory.html"><i class="fa fa-check"></i>統計的仮説検定</a>
<ul>
<li class="chapter" data-level="" data-path="testtheory.html"><a href="testtheory.html#nullhypo"><i class="fa fa-check"></i>検定の手順と仮説</a></li>
<li class="chapter" data-level="" data-path="testtheory.html"><a href="testtheory.html#twotail"><i class="fa fa-check"></i>母平均の検定（両側検定）に関する理屈</a></li>
<li class="chapter" data-level="" data-path="testtheory.html"><a href="testtheory.html#onetail"><i class="fa fa-check"></i>片側検定の紹介</a></li>
<li class="chapter" data-level="" data-path="testtheory.html"><a href="testtheory.html#errors"><i class="fa fa-check"></i>有意水準と検定における誤り</a></li>
<li class="chapter" data-level="" data-path="testtheory.html"><a href="testtheory.html#testresults"><i class="fa fa-check"></i>検定結果に関する解釈</a></li>
<li class="chapter" data-level="" data-path="testtheory.html"><a href="testtheory.html#lightbulb"><i class="fa fa-check"></i>電球データと検定</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="meancomparison.html"><a href="meancomparison.html"><i class="fa fa-check"></i>平均値に関するその他の検定</a></li>
<li class="chapter" data-level="" data-path="ANOVA.html"><a href="ANOVA.html"><i class="fa fa-check"></i>分散分析</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#%E5%88%86%E6%95%A3%E5%88%86%E6%9E%90%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6%E3%81%AE%E3%83%A2%E3%83%87%E3%83%AB%E8%A1%A8%E7%8F%BEanoatheory"><i class="fa fa-check"></i>分散分析についてのモデル表現*{#ANOAtheory}</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E4%BA%8C%E5%85%83%E9%85%8D%E7%BD%AE%E5%88%86%E6%95%A3%E5%88%86%E6%9E%90twowayanoa"><i class="fa fa-check"></i>二元配置分散分析*{#twowayANOA}</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E4%BA%8C%E5%85%83%E9%85%8D%E7%BD%AE%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E5%8A%B9%E6%9E%9C%E6%A4%9C%E5%AE%9Atwowaytest"><i class="fa fa-check"></i>二元配置モデルの効果検定*{#twowaytest}</a></li>
<li class="chapter" data-level="" data-path="ANOVA.html"><a href="ANOVA.html#tukey"><i class="fa fa-check"></i>多重比較とそれに伴う統計的問題</a></li>
<li class="chapter" data-level="" data-path="ANOVA.html"><a href="ANOVA.html#ANOVAwithR"><i class="fa fa-check"></i>Rによる分散分析の実行</a></li>
<li class="chapter" data-level="" data-path="ANOVA.html"><a href="ANOVA.html#ANOVAandReg"><i class="fa fa-check"></i>回帰分析と分散分析の関係</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pwr.html"><a href="pwr.html"><i class="fa fa-check"></i>検定力分析とサンプルサイズ</a></li>
<li class="chapter" data-level="" data-path="ch4reference.html"><a href="ch4reference.html"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="regintro.html"><a href="regintro.html"><i class="fa fa-check"></i>回帰分析</a>
<ul>
<li class="chapter" data-level="" data-path="ch5Intro.html"><a href="ch5Intro.html"><i class="fa fa-check"></i>本章の概要</a></li>
<li class="chapter" data-level="" data-path="regpreparation.html"><a href="regpreparation.html"><i class="fa fa-check"></i>分析準備</a></li>
<li class="chapter" data-level="" data-path="prediction.html"><a href="prediction.html"><i class="fa fa-check"></i>単回帰モデルと予測値</a>
<ul>
<li class="chapter" data-level="" data-path="prediction.html"><a href="prediction.html#lmmodel"><i class="fa fa-check"></i>企業データを用いた回帰分析の実行</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multiplereg.html"><a href="multiplereg.html"><i class="fa fa-check"></i>重回帰モデル</a>
<ul>
<li class="chapter" data-level="" data-path="multiplereg.html"><a href="multiplereg.html#mregIntro"><i class="fa fa-check"></i>重回帰モデル概要</a></li>
<li class="chapter" data-level="" data-path="multiplereg.html"><a href="multiplereg.html#mreginterpret"><i class="fa fa-check"></i>回帰係数の解釈</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="modelcomp.html"><a href="modelcomp.html"><i class="fa fa-check"></i>単回帰モデルと重回帰モデルの比較</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="regtechnic.html"><a href="regtechnic.html"><i class="fa fa-check"></i>回帰分析上の工夫紹介</a>
<ul>
<li class="chapter" data-level="" data-path="ch6Intro.html"><a href="ch6Intro.html"><i class="fa fa-check"></i>本章の概要</a></li>
<li class="chapter" data-level="" data-path="dummy.html"><a href="dummy.html"><i class="fa fa-check"></i>ダミー変数</a>
<ul>
<li class="chapter" data-level="" data-path="dummy.html"><a href="dummy.html#dummywithR"><i class="fa fa-check"></i>企業データを用いた分析の実行</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="interaction.html"><a href="interaction.html"><i class="fa fa-check"></i>交差項</a>
<ul>
<li class="chapter" data-level="" data-path="interaction.html"><a href="interaction.html#slopedummy"><i class="fa fa-check"></i>傾きダミー</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E5%82%BE%E3%81%8D%E3%83%80%E3%83%9F%E3%83%BC%E3%81%AE%E5%AE%9F%E8%A1%8Cslopedummywithr"><i class="fa fa-check"></i>傾きダミーの実行{slopedummywithR}</a></li>
<li class="chapter" data-level="" data-path="interaction.html"><a href="interaction.html#id_5"><i class="fa fa-check"></i>量的変数同士の交差項</a></li>
<li class="chapter" data-level="" data-path="interaction.html"><a href="interaction.html#interactionwithR"><i class="fa fa-check"></i>交差項モデルの実行</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="coefComparison.html"><a href="coefComparison.html"><i class="fa fa-check"></i>係数比較</a>
<ul>
<li class="chapter" data-level="" data-path="coefComparison.html"><a href="coefComparison.html#coefComparisonwithR"><i class="fa fa-check"></i>係数比較の実行</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="logLinearModel.html"><a href="logLinearModel.html"><i class="fa fa-check"></i>対数線形</a>
<ul>
<li class="chapter" data-level="" data-path="logLinearModel.html"><a href="logLinearModel.html#logLinearwithR"><i class="fa fa-check"></i>対数線形モデルの分析実行</a></li>
<li class="chapter" data-level="" data-path=""><a href="#%E9%9C%80%E8%A6%81%E3%81%AE%E4%BE%A1%E6%A0%BC%E5%BC%BE%E5%8A%9B%E6%80%A7%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6elasticity"><i class="fa fa-check"></i>需要の価格弾力性について*{#elasticity}</a></li>
<li class="chapter" data-level="" data-path="logLinearModel.html"><a href="logLinearModel.html#linearTest"><i class="fa fa-check"></i>対数線形の推定と検定</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch6Reference.html"><a href="ch6Reference.html"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">マーケティング・データ分析補足資料</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="interaction" class="section level2 hasAnchor">
<h2>交差項<a href="interaction.html#interaction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>マーケティングに関する研究では、ある説明変数の被説明変数に与える影響が、別の説明変数に影響を受ける形で変化することを捉えることも多い。このような変数間の関係に影響するような効果を調整効果（moderating effect）もしくは相互作用効果（interaction effect）と言い、以下のような図で示されることが多い。</p>
<div class="float">
<img src="reg/moderate.png" style="width:70.0%" alt="調整効果イメージ図" />
<div class="figcaption">調整効果イメージ図</div>
</div>
<p>上の図では、メインの説明変数と調整変数が存在するかのように見えるが、分析に置いてはどちらか一方をメインと扱うことはなく、<em>X</em>と<em>Z</em>をかけ合わせた交差項を含めたモデルを分析する。なお、調整効果もしくは相互作用効果の分析ではダミー変数もしくは量的変数のどちらも用いることができる。</p>
<div class="float">
<img src="reg/moderate2.png" style="width:70.0%" alt="交差項イメージ図" />
<div class="figcaption">交差項イメージ図</div>
</div>
<p>回帰モデルにおける交差項の利用には、以下の点に注意が必要である。</p>
<ol style="list-style-type: decimal">
<li>交差項には、条件付き効果に関する作業仮説を論じる必要がある。</li>
</ol>
<ul>
<li>例、XがYに与える影響は、Zの値に応じて変化する。</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>交差項を含むモデルには交差項を構成する二つの変数も含める。</li>
</ol>
<ul>
<li>推定モデル上、どちらか一方がメインかのような特定化は行わない。</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>交差項を構成する二つの変数の係数を従来の回帰分析結果と同じように解釈してはいけない。</li>
</ol>
<ul>
<li>説明変数独立項の係数の意味について注意が必要。</li>
</ul>
<div id="slopedummy" class="section level3 hasAnchor">
<h3>傾きダミー<a href="interaction.html#slopedummy" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>先述の注意点について、具体例を見ながら確認していく。まず、量的変数とダミー変数の交差項について考える。ダミー変数と量的変数の交差項を作ることによって、傾きがグループによって変わるか否かを捉えることができる。交差項を含む回帰モデルは以下のように示される。</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 x_i+\beta_2D_i+\beta_3(x_i\times D_i)+u_i
\]</span></p>
<p><span class="math inline">\(\small x_i\)</span> が <span class="math inline">\(\small y_i\)</span> に与える影響を <span class="math inline">\(\small \Delta y_i/\Delta x_i\)</span> とすると、それぞれ以下のように示される。</p>
<p><span class="math display">\[
\begin{cases}
D_i=1\Rightarrow &amp; \frac{\Delta y_i}{\Delta x_i}=\beta_1+\beta_3\\
D_i=0\Rightarrow &amp; \frac{\Delta y_i}{\Delta x_i}=\beta_1
\end{cases}
\]</span>
つまり、<span class="math inline">\(\small x\)</span> が <span class="math inline">\(\small y\)</span> に与える影響（傾き）が、<span class="math inline">\(\small \beta_3\)</span> の分だけ、ダミー変数のカテゴリーによって変化することが伺える。<span class="math inline">\(\small \beta_1\)</span> は <span class="math inline">\(\small D=0\)</span> の際の <em>x</em> の効果であり、 <span class="math inline">\(\small D=1\)</span> の際の効果は、<span class="math inline">\(\small \beta_1+\beta_3\)</span> で表される。 そのため、このようなダミー変数の使い方を「傾きダミー（Slope dummy）」と呼ぶことも多い。</p>
</div>
<div id="傾きダミーの実行slopedummywithr" class="section level3 hasAnchor">
<h3>傾きダミーの実行{slopedummywithR}<a href="#%E5%82%BE%E3%81%8D%E3%83%80%E3%83%9F%E3%83%BC%E3%81%AE%E5%AE%9F%E8%A1%8Cslopedummywithr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>先程の firmdara19 にこの分析モデルを適応してみる。Rにおける交差項の導入は、<code>lm(y ~ x * d)</code> のように指定すれば、<em>x</em>と<em>d</em>の交差項とそれぞれの独立項を自動でモデルに含めてくれる。</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="interaction.html#cb193-1" tabindex="-1"></a>fit.d3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(op <span class="sc">~</span>  mkexp <span class="sc">*</span> retail, <span class="at">data =</span> firmdata19)</span>
<span id="cb193-2"><a href="interaction.html#cb193-2" tabindex="-1"></a><span class="fu">summary</span>(fit.d3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = op ~ mkexp * retail, data = firmdata19)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.100914 -0.027907 -0.006023  0.020847  0.254339 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   0.112780   0.009123  12.362  &lt; 2e-16 ***
## mkexp        -0.106801   0.026898  -3.971 0.000113 ***
## retail       -0.099242   0.021752  -4.563 1.08e-05 ***
## mkexp:retail  0.205666   0.060393   3.405 0.000859 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.0518 on 142 degrees of freedom
## Multiple R-squared:  0.203,  Adjusted R-squared:  0.1862 
## F-statistic: 12.06 on 3 and 142 DF,  p-value: 4.461e-07</code></pre>
<p>分析の結果、マーケティング支出と小売ダミーは負に有意である一方で、両変数の交差項（`<code>mkexp:retail</code>）は正に有意であることが示された。このとき、<code>mkexp</code> の単独項は、<code>retail</code> が0のとき、つまりその他グループにおけるマーケティング支出と利益率の関係を示しており、それが負に有意であると理解できる。そして、<code>mkexp:retail</code> の項が正に有意であることから、その他グループの傾きと、小売グループの傾きは有意に異なることが伺える。もう少し詳細にこの結果を整理すると、本分析による利益率の予測値 <span class="math inline">\(\hat{y}\)</span>は以下のように示すことができる。</p>
<p><span class="math display">\[
\hat{y}_i = 0.108430 - 0.105662\text{mkexp}_i - 0.088147\text{retail}_i + 0.191432\text{mkexp}_i * \text{retail}_i
\]</span></p>
<p><span class="math display">\[
\begin{cases}
\text{Retail}: &amp;\hat{y}_i = 0.020283 + 0.08577\text{mkexp}_i\\
\text{Others}: &amp;\hat{y}_i = 0.108430 - 0.105662\text{mkexp}_i
\end{cases}
\]</span></p>
<p>交差項を用いた分析を実行する場合、分析結果をより詳細に理解するため、結果を図示化することが大切になる。具体的には以下のように、分析結果からカテゴリ別に予測値をそれぞれ計算し、図示化することで、含意を得ることができる。ここでは、<code>sjPlot</code>というパッケージの <code>plot_model()</code> 関数を用いて、分析結果に基づく被説明変数の予測値を図示化する。まず、パッケージをインストールして欲しい。</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="interaction.html#cb195-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;sjPlot&quot;</span>)</span></code></pre></div>
<p>今回の図示化のために、<code>plot_model()</code> 関数内では、<code>type = "pred"</code> と予測値を計算するための引数を指定した上で、<code>terms</code> において着目する変数名を特定する。また、この関数では、ggplot2のように、図示化に関する凡例や軸ラベルなどの様々な情報を書き足していくことができる。</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="interaction.html#cb196-1" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb196-2"><a href="interaction.html#cb196-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb196-3"><a href="interaction.html#cb196-3" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(fit.d3, <span class="at">type =</span> <span class="st">&quot;pred&quot;</span>, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">&quot;mkexp&quot;</span>,<span class="st">&quot;retail&quot;</span>), <span class="at">ci.lvl =</span> .<span class="dv">95</span>) <span class="sc">+</span></span>
<span id="cb196-4"><a href="interaction.html#cb196-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Slope Analysis&quot;</span>,</span>
<span id="cb196-5"><a href="interaction.html#cb196-5" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;(Predicted Values of Profitability with 95% Confdence Intervals)&quot;</span>,</span>
<span id="cb196-6"><a href="interaction.html#cb196-6" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Marketing Expense&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Profitability&quot;</span>) <span class="sc">+</span></span>
<span id="cb196-7"><a href="interaction.html#cb196-7" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Retail Dummy&quot;</span>)</span>
<span id="cb196-8"><a href="interaction.html#cb196-8" tabindex="-1"></a>pred</span></code></pre></div>
<p><img src="05-reg2_files/figure-html/slopeanalysis-1.png" width="672" /></p>
<p>分析の結果、小売企業においてはマーケティング支出と利益率の関係は右上がりである一方で、その他の企業では右下がりである。回帰分析における交差項の係数がこの傾きの違いを示している。また、実線を比較すると マーケティング支出が 0.5 辺りを境に小売企業の利益率の予測値のほうがその他グループよりも高くなっているように見える<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a>。しかしながら、両直線の95%信頼区間は重なっており、統計的に有意な差があるとは言えない。そのため、マーケティング支出が高いとき、小売企業の利益率（の予測値）のほうが有意に高いとは言えない。</p>
</div>
<div id="id_5" class="section level3 hasAnchor">
<h3>量的変数同士の交差項<a href="interaction.html#id_5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>交差項を用いた分析は量的変数同士にも応用できる。しかしながら、交差項を用いた分析結果の解釈には注意が必要であり、分析の実行においても工夫が求められる。量的変数同士の交差項モデルとして、以下の回帰式を考える。</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 x_i+\beta_2z_i+\beta_3(x_i\times z_i)+u_i
\]</span></p>
<p>上記における <em>x</em> と <em>z</em> はどちらも量的変数であり、<em>x</em> が <em>y</em> に与えるパーシャル効果は、以下のように表すことができる。</p>
<p><span class="math display">\[
\frac{\Delta y_i}{\Delta x_i}=\beta_1+\beta_3z_i
\]</span>
同様に、<em>z</em> が <em>y</em> に与えるパーシャル効果は、</p>
<p><span class="math display">\[
\frac{\Delta y_i}{\Delta z_i}=\beta_2+\beta_3x_i
\]</span>
となる。したがって、<em>x</em> と <em>z</em> が <em>y</em> に与える影響は、互いに依存しあっていることがわかる。上式の <span class="math inline">\(\small \beta_3\)</span> は調整効果や相互作用効果と呼ばれる。</p>
<p>交差項を用いた回帰モデルでは、説明変数の独立項に関する解釈に注意が必要となる。例えば上式の <span class="math inline">\(\small \beta_1\)</span>（<span class="math inline">\(\small \beta_2\)</span>）はどのような条件で <em>x</em>（<em>z</em>）が <em>y</em> に与える影響だと解釈できるだろうか。例えば、上記のモデルにおける <em>y</em> が体重、 <em>x</em> と <em>z</em> がそれぞれ筋肉量と身長だったとする。このとき、筋肉量が体重に与える影響は、
<span class="math display">\[
\frac{\Delta y_i}{\Delta x_i}=\beta_1+\beta_3z_i
\]</span></p>
<p>であり、<span class="math inline">\(\small \beta_1\)</span> は「身長（<em>z</em>）が0」という条件下で筋肉量が体重に与える影響を表している。しかしながら、身長が0のときという非現実的な条件下での結果は、我々にとって解釈が難しく、また情報としても有益でないかもしれない。この問題への対策のひとつが「平均値での中心化（mean-centering）」である。これは、交差項に用いる説明変数に関して、平均からの偏差を用いる方法である。中心化された変数による交差項モデルは以下のように示される。</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 (x_i-\bar{x})+\beta_2(z_i-\bar{z})+\beta_3(x_i-\bar{x})\times (z_i-\bar{z})+u_i
\]</span></p>
<p>これにより、<em>x</em> の効果は以下のように示される。</p>
<p><span class="math display">\[
\frac{\Delta y_i}{\Delta x_i}=\beta_1+\beta_3(z_i-\bar{z})
\]</span></p>
<p>そのため、中心化されたモデルにおける<span class="math inline">\(\small \beta_1\)</span> は、<span class="math inline">\(\small z_i-\bar{z}=0\)</span>、つまり「<em>z</em> が平均値」の際の、<em>x</em> 効果だと解釈できる。また、平均値以外の値を用いた中心化も当然可能であるため、研究・実務上関心の強い値（何らかの閾値など）がある場合には、それを基準とした中心化もできる。</p>
</div>
<div id="interactionwithR" class="section level3 hasAnchor">
<h3>交差項モデルの実行<a href="interaction.html#interactionwithR" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>ここで、量的変数を用いた交差項モデルをRで分析する。分析の実行方法は、前節の傾きダミーと同様である。ここでは、“headphone07.csv” という、ある年のヘッドフォン製品の売上を捉えたデータセット（人工架空データ）を用いる。このデータは、以下の変数を含んでいる。</p>
<ul>
<li>売上（百万円）</li>
<li>プロモーション投資額（百万円）</li>
<li>R&amp;D投資額（百万円）</li>
</ul>
<p>このデータセットに対して、本分析ではR&amp;Dによって向上する（と仮定する）製品品質とプロモーションの相互作用が売上に与える影響を分析する。具体的には、たとえ良いものを作っても、きちんとその情報を消費者に伝達しないといけないのではないかという課題を捉える。そのため本分析を通じて、製品品質への投資（R&amp;D投資）が売上に与える影響が、プロモーション量に応じて変化するのではないかという研究課題に答える。まず以下のようにデータを読み込み、データフレームを確認する。</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="interaction.html#cb197-1" tabindex="-1"></a>Headphone07 <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;data/headphone07.csv&quot;</span>, <span class="at">na =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb197-2"><a href="interaction.html#cb197-2" tabindex="-1"></a></span>
<span id="cb197-3"><a href="interaction.html#cb197-3" tabindex="-1"></a><span class="co">#データフレームの確認</span></span>
<span id="cb197-4"><a href="interaction.html#cb197-4" tabindex="-1"></a><span class="fu">glimpse</span>(Headphone07)</span></code></pre></div>
<pre><code>## Rows: 221
## Columns: 4
## $ ID        &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 1…
## $ sales     &lt;dbl&gt; 118.8377, 548.6312, 197.3075, 104.2657, 748.8251, 947.8850, …
## $ rd        &lt;dbl&gt; 404.0893, 252.1270, 444.3374, 407.5876, 841.7605, 336.8744, …
## $ promotion &lt;dbl&gt; 75.63163, 102.74572, 97.98040, 83.46613, 105.69250, 80.17476…</code></pre>
<p>このデータに対して、まずは以下の通り中心化していない変数を用いて分析を行う。</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="interaction.html#cb199-1" tabindex="-1"></a>fit_int <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> rd<span class="sc">*</span>promotion, <span class="at">data =</span> Headphone07)</span>
<span id="cb199-2"><a href="interaction.html#cb199-2" tabindex="-1"></a><span class="fu">summary</span>(fit_int)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ rd * promotion, data = Headphone07)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -46.522 -12.861  -0.638  13.578  70.667 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   2.033e+04  1.090e+02   186.5   &lt;2e-16 ***
## rd           -5.187e+01  2.844e-01  -182.4   &lt;2e-16 ***
## promotion    -1.914e+02  1.052e+00  -181.9   &lt;2e-16 ***
## rd:promotion  4.979e-01  2.730e-03   182.4   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 20.55 on 217 degrees of freedom
## Multiple R-squared:  0.9935, Adjusted R-squared:  0.9934 
## F-statistic: 1.111e+04 on 3 and 217 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>分析の結果、rdとpromotion の交差項は正に有意だが、どちらの独立項も負に有意であった。また、先述の通りこれらの独立項の係数は、もう一方の変数が0のときのそれぞれの効果を表しており、現実的には解釈が難しい結果になっている。したがって、以下の様に中心化変数を作成し、回帰分析を実行する。</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="interaction.html#cb201-1" tabindex="-1"></a>Headphone07 <span class="ot">&lt;-</span> Headphone07 <span class="sc">%&gt;%</span> </span>
<span id="cb201-2"><a href="interaction.html#cb201-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">promotion_c =</span> promotion <span class="sc">-</span> <span class="fu">mean</span>(promotion, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb201-3"><a href="interaction.html#cb201-3" tabindex="-1"></a>         <span class="at">rd_c =</span> rd <span class="sc">-</span> <span class="fu">mean</span>(rd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb201-4"><a href="interaction.html#cb201-4" tabindex="-1"></a></span>
<span id="cb201-5"><a href="interaction.html#cb201-5" tabindex="-1"></a>fit_int_c <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> rd_c<span class="sc">*</span>promotion_c , <span class="at">data =</span> Headphone07)</span>
<span id="cb201-6"><a href="interaction.html#cb201-6" tabindex="-1"></a><span class="fu">summary</span>(fit_int_c)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ rd_c * promotion_c, data = Headphone07)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -46.522 -12.861  -0.638  13.578  70.667 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      382.27812    1.51459  252.40   &lt;2e-16 ***
## rd_c              -0.91767    0.01196  -76.75   &lt;2e-16 ***
## promotion_c        0.69039    0.03972   17.38   &lt;2e-16 ***
## rd_c:promotion_c   0.49792    0.00273  182.37   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 20.55 on 217 degrees of freedom
## Multiple R-squared:  0.9935, Adjusted R-squared:  0.9934 
## F-statistic: 1.111e+04 on 3 and 217 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>分析の結果、交差項の結果については非中心化モデルと同じであることが伺える。一方で独立項については、rdは負に、promotionは正に有意であることが明らかになった。つまり、プロモーションが平均値である場合、rdにコストを掛けても売上には繋がらない一方で、rdが平均値の場合、プロモーションによって売上が伸びることが伺える。これをまとめると、品質が平均的ならプロモーションで売上は上がるが、プロモーションが平均的で品質投資をしても売上に逆効果となることが伺える。R&amp;D投資による負の効果については価格との関係もあるかもしれない。品質が向上すると通常価格も上がるため、プロモーションがあまり高くない状態においては、価格の向上によって売上を損ねるかもしれない。この点については、価格も含めたさらなる調査、分析が必要になる。</p>
<div id="interactionVis" class="section level4 hasAnchor">
<h4>分析結果の図示化<a href="interaction.html#interactionVis" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>量的変数同士の交差項分析結果の図示化においては、二種類の方法がある。一つ目は調整変数として捉える変数を高水準（例、平均 <span class="math inline">\(+\)</span> 1標準偏差）と低水準（例、平均 <span class="math inline">\(-\)</span> 1標準偏差）に二分し、前節の傾きダミーの図示化のようにそれぞれの場合でメイン変数による被説明変数への傾きを描画する方法である。これは、前節で使用した<code>sjPlot</code>パッケージで実行できる。 二つ目は、メインの変数が被説明変数へ与える影響を縦軸に、調整変数の値を横軸に取ることによって、メイン変数が持つ効果が調整変数によって変化する様子を連続的に描画する方法である。これは、<code>marginaleffects</code>というパッケージを用いる。</p>
<p>まず、一つ目の方法は、以下の通り実行することができる。分析の結果、やはりプロモーション水準が低い場合にはR&amp;D投資が売上に与える影響は負であるものの、プロモーション水準が高い場合には正に転じることが伺える。</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="interaction.html#cb203-1" tabindex="-1"></a>leg <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Mean - 1sd&quot;</span>, <span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Mean + 1sd&quot;</span>)</span>
<span id="cb203-2"><a href="interaction.html#cb203-2" tabindex="-1"></a>int_fig1 <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(fit_int_c, <span class="at">type =</span> <span class="st">&quot;int&quot;</span>, <span class="at">mdrt.values =</span> <span class="st">&quot;meansd&quot;</span>, <span class="at">ci.lvl =</span> .<span class="dv">9999999999</span>) <span class="sc">+</span></span>
<span id="cb203-3"><a href="interaction.html#cb203-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Predicted values of Sales (R&amp;D * Promotion)&quot;</span>,</span>
<span id="cb203-4"><a href="interaction.html#cb203-4" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;R&amp;D Investment&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Sales&quot;</span>)<span class="sc">+</span> </span>
<span id="cb203-5"><a href="interaction.html#cb203-5" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Promotion level&quot;</span>, <span class="at">labels=</span>leg)</span></code></pre></div>
<pre><code>## Scale for colour is already present.
## Adding another scale for colour, which will replace the existing scale.</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="interaction.html#cb205-1" tabindex="-1"></a>int_fig1</span></code></pre></div>
<p><img src="05-reg2_files/figure-html/slopeHeadphone-1.png" width="672" /></p>
<p>続いて、二つ目の方法を実行するために、以下の要領でパッケージをインストールしてほしい。<code>marginaleffects</code> は、<code>margins</code> や <code>emtrends</code> の機能を引き継ぎ、限界効果に関する計算結果を図示化するためのパッケージである<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a>。</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="interaction.html#cb206-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;marginaleffects&quot;</span>)</span></code></pre></div>
<p>R&amp;D が 売上に与える影響（傾き）がどのように変化するかは、<code>plot_slopes()</code> という関数を用いる。以下は、傾きの変化に関する図の出力結果である。</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="interaction.html#cb207-1" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb207-2"><a href="interaction.html#cb207-2" tabindex="-1"></a>int_fig2 <span class="ot">&lt;-</span> <span class="fu">plot_slopes</span>(fit_int_c, <span class="at">variables =</span> <span class="st">&quot;rd_c&quot;</span>, <span class="at">condition =</span> <span class="st">&quot;promotion_c&quot;</span>, <span class="at">conf_level =</span> .<span class="dv">99999999</span>) <span class="sc">+</span></span>
<span id="cb207-3"><a href="interaction.html#cb207-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Marginal effects of R&amp;D on Sales&quot;</span>,</span>
<span id="cb207-4"><a href="interaction.html#cb207-4" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Promotion&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Slope of R&amp;D on Sales&quot;</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept=</span><span class="dv">0</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) </span>
<span id="cb207-5"><a href="interaction.html#cb207-5" tabindex="-1"></a>int_fig2</span></code></pre></div>
<p><img src="05-reg2_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>分析の結果、promotionが0（平均）である条件を基準に、R&amp;Dの傾きが正に転じていることが伺える。なお、よく見ると、直線の周りに灰色の影が描画されていることがわかる。これは、99%信頼区間を示している。今回は人工的に作成したデータなので、非常に当てはまりがよく信頼区間がとても狭くなっているが、実際のデータを用いて同様の図示化をすればもう少し明確に信頼区間を視認できる。このように、交差項を利用した回帰モデルを分析する際は、事後的な図示化を行うことを心がけると良い。この作業により実務的・学術的により有益な含意につながることがある。</p>
<!--- fit1_ame <- slopes(fit_int_c, variables = "rd_c",
                   newdata = datagrid(promotion_c = -86:155))--->
<p>以下は、<code>plot_slopes()</code> に関するおまけである。図示化の確認のために、firmdata19を使って、マーケティング支出と総資産との交差項により、利益率を説明する回帰モデルを考える。以下では、中心化と回帰分析の実行、図の出力を実施している（回帰分析結果は省略）。</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="interaction.html#cb208-1" tabindex="-1"></a>firmdata19 <span class="ot">&lt;-</span> firmdata19 <span class="sc">%&gt;%</span> </span>
<span id="cb208-2"><a href="interaction.html#cb208-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mkexp_c =</span> mkexp <span class="sc">-</span> <span class="fu">mean</span>(mkexp),</span>
<span id="cb208-3"><a href="interaction.html#cb208-3" tabindex="-1"></a>         <span class="at">asset_c =</span> total_assets <span class="sc">-</span> <span class="fu">mean</span>(total_assets))</span>
<span id="cb208-4"><a href="interaction.html#cb208-4" tabindex="-1"></a></span>
<span id="cb208-5"><a href="interaction.html#cb208-5" tabindex="-1"></a>fit_int2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(op <span class="sc">~</span>  mkexp_c <span class="sc">*</span> asset_c, <span class="at">data =</span> firmdata19)</span>
<span id="cb208-6"><a href="interaction.html#cb208-6" tabindex="-1"></a></span>
<span id="cb208-7"><a href="interaction.html#cb208-7" tabindex="-1"></a>int_fig3 <span class="ot">&lt;-</span> <span class="fu">plot_slopes</span>(fit_int2, <span class="at">variables =</span> <span class="st">&quot;mkexp_c&quot;</span>, <span class="at">condition =</span> <span class="st">&quot;asset_c&quot;</span>, <span class="at">conf_level =</span> <span class="fl">0.99</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept=</span><span class="dv">0</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) </span>
<span id="cb208-8"><a href="interaction.html#cb208-8" tabindex="-1"></a>int_fig3</span></code></pre></div>
<p><img src="05-reg2_files/figure-html/omake-1.png" width="672" /></p>
<p>図を見ると、Headphoneデータよりもはっきりと信頼区間が視認できる。マーケティング支出の効果は資産によって低下するように見えるが、信頼区間を考慮すると、資産額が平均値（asset_c <span class="math inline">\(=0\)</span>）付近の値を取るときのみマーケティング支出は負に有意の影響を持つが、それ以外の区間では有意でない（信頼区間に0を含む）ことが伺える。このように、信頼区間の出力は結果の解釈を有意義なものにしてくれる。</p>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="9">
<li id="fn9"><p>試しに、<code>plot_model</code> 内の信頼区間に関する引数を <code>ci.lvl = NA</code>とし、実線のみの比較を確認して見て欲しい<a href="interaction.html#fnref9" class="footnote-back">↩︎</a></p></li>
<li id="fn10"><p>本講義では、詳細は割愛するが以下から詳細を確認できる <a href="https://vincentarelbundock.github.io/marginaleffects/dev/" class="uri">https://vincentarelbundock.github.io/marginaleffects/dev/</a><a href="interaction.html#fnref10" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dummy.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="coefComparison.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-reg2.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection",
    "scroll_highlight": true
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
